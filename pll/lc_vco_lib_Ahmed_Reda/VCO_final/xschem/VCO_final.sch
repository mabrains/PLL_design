v {xschem version=3.1.0 file_version=1.2 }
G {}
K {}
V {}
S {}
E {}
N 3250 -3480 3250 -3460 {
lab=GND}
N 3250 -3550 3250 -3540 {
lab=VDD}
N 2660 -3500 2660 -3480 {
lab=VDD}
N 2660 -3510 2660 -3500 {
lab=VDD}
N 2660 -3450 2660 -3430 {
lab=#net1}
N 2660 -3430 2660 -3400 {
lab=#net1}
N 2660 -3560 2660 -3530 {
lab=VDD}
N 2660 -3530 2660 -3510 {
lab=VDD}
N 2660 -3430 2750 -3430 {
lab=#net1}
N 2710 -3480 2790 -3480 {
lab=#net1}
N 2700 -3480 2710 -3480 {
lab=#net1}
N 2750 -3430 2810 -3430 {
lab=#net1}
N 2450 -3140 2450 -3110 {
lab=GND}
N 2450 -3170 2450 -3140 {
lab=GND}
N 2450 -3250 2450 -3200 {
lab=#net2}
N 2450 -3250 2520 -3250 {
lab=#net2}
N 2520 -3250 2520 -3170 {
lab=#net2}
N 2490 -3170 2520 -3170 {
lab=#net2}
N 2260 -3180 2260 -3150 {
lab=GND}
N 2260 -3210 2260 -3180 {
lab=GND}
N 2260 -3500 2260 -3470 {
lab=VDD}
N 2260 -3470 2260 -3450 {
lab=VDD}
N 2380 -3330 2410 -3330 {
lab=#net2}
N 2410 -3330 2450 -3330 {
lab=#net2}
N 2450 -3330 2450 -3250 {
lab=#net2}
N 2660 -3140 2660 -3110 {
lab=GND}
N 2660 -3170 2660 -3140 {
lab=GND}
N 2590 -3170 2620 -3170 {
lab=#net2}
N 2520 -3170 2590 -3170 {
lab=#net2}
N 2660 -3400 2660 -3200 {
lab=#net1}
N 2790 -3480 2810 -3480 {
lab=#net1}
N 2810 -3480 2830 -3480 {
lab=#net1}
N 3030 -3280 3090 -3280 {
lab=vp}
N 3090 -3280 3090 -3210 {
lab=vp}
N 3090 -3210 3210 -3210 {
lab=vp}
N 3210 -3250 3210 -3210 {
lab=vp}
N 3110 -3280 3170 -3280 {
lab=vn}
N 3110 -3280 3110 -3230 {
lab=vn}
N 2990 -3230 3110 -3230 {
lab=vn}
N 2990 -3250 2990 -3230 {
lab=vn}
N 2990 -3360 2990 -3310 {
lab=#net3}
N 2990 -3360 3210 -3360 {
lab=#net3}
N 3210 -3360 3210 -3310 {
lab=#net3}
N 2990 -3230 2990 -3140 {
lab=vn}
N 3210 -3210 3210 -3140 {
lab=vp}
N 3030 -2400 3090 -2400 {
lab=vp}
N 3090 -2450 3090 -2400 {
lab=vp}
N 3090 -2480 3210 -2480 {
lab=vp}
N 3210 -2450 3210 -2430 {
lab=vp}
N 3120 -2400 3170 -2400 {
lab=vn}
N 3120 -2430 3120 -2400 {
lab=vn}
N 3090 -2480 3090 -2450 {
lab=vp}
N 3210 -2480 3210 -2450 {
lab=vp}
N 3120 -2460 3120 -2430 {
lab=vn}
N 2990 -2460 3120 -2460 {
lab=vn}
N 2990 -2460 2990 -2430 {
lab=vn}
N 2990 -3300 2990 -3280 {
lab=#net3}
N 2990 -3310 2990 -3300 {
lab=#net3}
N 3210 -3310 3210 -3280 {
lab=#net3}
N 2990 -2370 2990 -2340 {
lab=GND}
N 3210 -2370 3210 -2340 {
lab=GND}
N 3210 -3140 3290 -3140 {
lab=vp}
N 2890 -3140 2990 -3140 {
lab=vn}
N 2990 -2400 2990 -2370 {
lab=GND}
N 3210 -2400 3210 -2370 {
lab=GND}
N 2990 -3140 2990 -2800 {
lab=vn}
N 3210 -3140 3210 -2820 {
lab=vp}
N 3130 -2980 3210 -2980 {
lab=vp}
N 2990 -2980 3070 -2980 {
lab=vn}
N 3090 -3080 3120 -3080 {
lab=#net4}
N 2990 -3080 3030 -3080 {
lab=vn}
N 3180 -3080 3210 -3080 {
lab=vp}
N 3130 -2890 3210 -2890 {
lab=vp}
N 2990 -2890 3070 -2890 {
lab=vn}
N 2860 -3100 2860 -3070 {
lab=vn}
N 2910 -3100 2990 -3100 {
lab=vn}
N 2860 -3100 2910 -3100 {
lab=vn}
N 3300 -3100 3300 -3070 {
lab=vp}
N 3210 -3100 3300 -3100 {
lab=vp}
N 2860 -3010 2860 -2980 {
lab=GND}
N 3300 -3010 3300 -2980 {
lab=GND}
N 2990 -2800 2990 -2460 {
lab=vn}
N 3210 -2820 3210 -2480 {
lab=vp}
N 3090 -3560 3090 -3510 {
lab=VDD}
N 3090 -3500 3090 -3480 {
lab=VDD}
N 3090 -3510 3090 -3500 {
lab=VDD}
N 3090 -3450 3090 -3430 {
lab=#net3}
N 3090 -3370 3090 -3360 {
lab=#net3}
N 2930 -3480 2990 -3480 {
lab=#net1}
N 3030 -3480 3050 -3480 {
lab=#net1}
N 2990 -3480 3030 -3480 {
lab=#net1}
N 3090 -3430 3090 -3370 {
lab=#net3}
N 3040 -2730 3040 -2710 {
lab=#net5}
N 3040 -2730 3080 -2730 {
lab=#net5}
N 3080 -2730 3080 -2630 {
lab=#net5}
N 3040 -2630 3080 -2630 {
lab=#net5}
N 3040 -2650 3040 -2630 {
lab=#net5}
N 3270 -2680 3270 -2660 {
lab=GND}
N 3270 -2750 3270 -2740 {
lab=#net5}
N 3040 -2680 3060 -2680 {
lab=GND}
N 3160 -2730 3160 -2710 {
lab=#net5}
N 3120 -2730 3160 -2730 {
lab=#net5}
N 3120 -2730 3120 -2630 {
lab=#net5}
N 3120 -2630 3160 -2630 {
lab=#net5}
N 3160 -2650 3160 -2630 {
lab=#net5}
N 3140 -2680 3160 -2680 {
lab=GND}
N 3060 -2680 3060 -2580 {
lab=GND}
N 3140 -2680 3140 -2580 {
lab=GND}
N 3060 -2570 3100 -2570 {
lab=GND}
N 3060 -2580 3060 -2570 {
lab=GND}
N 3100 -2570 3140 -2570 {
lab=GND}
N 3140 -2580 3140 -2570 {
lab=GND}
N 3200 -2680 3210 -2680 {
lab=vp}
N 3080 -2680 3120 -2680 {
lab=#net5}
N 2990 -2680 3000 -2680 {
lab=vn}
N 3130 -2750 3270 -2750 {
lab=#net5}
N 3130 -2750 3130 -2730 {
lab=#net5}
N 3120 -2790 3210 -2790 {
lab=vp}
N 2990 -2790 3060 -2790 {
lab=vn}
N 2810 -3430 2870 -3430 {
lab=#net1}
N 2870 -3480 2870 -3430 {
lab=#net1}
N 2850 -3480 2870 -3480 {
lab=#net1}
N 2870 -3480 2930 -3480 {
lab=#net1}
N 2830 -3480 2850 -3480 {
lab=#net1}
C {sky130_fd_pr/corner.sym} 3650 -3340 0 0 {name=CORNER only_toplevel=false corner=tt}
C {devices/code_shown.sym} 3660 -3150 0 0 {name=SPICE only_toplevel=false value="
.save all
.nodeset v(vout)=0
.control
compose  vctrl_vector   start=0         stop=1.6          step=0.05
let vctrl_counter = 0
let f_osc = vector(length(vctrl_vector))
let curr_value = vctrl_vector[0]
set appendwrite
while vctrl_counter < length(vctrl_vector)
    print curr_value
    alter VTuner  $&curr_value
    tran 0.01ns 100ns
    let vdiff = v(vp)-v(vn)
    meas tran tperiod TRIG vdiff VAL=0.5 RISE=30 TARG vdiff VAL=0.5 RISE=31
    let freq = 1/tperiod
    setplot op1
    let f_osc[vctrl_counter] = tran.freq
    *wrdata fosc_vs_vctrl.csv f_osc[vctrl_counter]
    reset
    let vctrl_counter = vctrl_counter + 1
    let curr_value = vctrl_vector[vctrl_counter]
end

let kvco = vecd(f_osc)
write output.txt f_osc
print f_osc
plot f_osc vs vctrl_vector
*plot kvco vs vctrl_vector xlimit 0.5 1.6
*print kvco
.endc
"}
C {devices/vsource.sym} 3250 -3510 0 0 {name=VDD value=1.8}
C {devices/gnd.sym} 3250 -3460 0 0 {name=l6 lab=GND}
C {devices/vdd.sym} 3250 -3540 0 0 {name=l7 lab=VDD}
C {devices/vdd.sym} 2660 -3560 0 0 {name=l11 lab=VDD}
C {../../BGR_Banba/xschem/BGR_Banba.sym} 2390 -3630 0 0 {name=X1}
C {devices/gnd.sym} 2450 -3110 0 0 {name=l14 lab=GND}
C {sky130_fd_pr/nfet_01v8.sym} 2470 -3170 0 1 {name=M8
L=1
W=10 
nf=1 mult=5
model=nfet_01v8
spiceprefix=X
}
C {devices/gnd.sym} 2260 -3150 0 0 {name=l15 lab=GND}
C {devices/vdd.sym} 2260 -3500 0 0 {name=l16 lab=VDD}
C {devices/gnd.sym} 2660 -3110 0 1 {name=l3 lab=GND}
C {sky130_fd_pr/nfet_01v8.sym} 2640 -3170 0 0 {name=M9
L=1
W=25
nf=1 mult=10
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 3190 -3280 0 0 {name=M11
L=0.15
W=50
nf=1 mult=5
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 3010 -3280 0 1 {name=M1
L=0.15
W=50
nf=1 mult=5
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 3190 -2400 0 0 {name=M2
L=0.15
W=20
nf=1 mult=5
model=nfet_01v8
spiceprefix=X
}
C {devices/gnd.sym} 2990 -2340 0 0 {name=l1 lab=GND}
C {devices/gnd.sym} 3210 -2340 0 0 {name=l2 lab=GND}
C {devices/ind.sym} 3150 -3080 1 0 {name=L1
m=1
value=4n
footprint=1206
device=inductor}
C {devices/res.sym} 3100 -2980 1 0 {name=R1
value=1182
footprint=1206
device=resistor
m=1}
C {devices/lab_pin.sym} 3290 -3140 2 0 {name=l4 sig_type=std_logic lab=vp}
C {devices/lab_pin.sym} 2890 -3140 0 0 {name=l5 sig_type=std_logic lab=vn}
C {devices/res.sym} 3060 -3080 1 0 {name=R2
value=3
footprint=1206
device=resistor
m=1}
C {devices/gnd.sym} 2860 -2980 0 0 {name=l8 lab=GND}
C {devices/gnd.sym} 3300 -2980 0 0 {name=l9 lab=GND}
C {devices/vdd.sym} 3090 -3560 0 0 {name=l10 lab=VDD}
C {sky130_fd_pr/nfet_01v8.sym} 3010 -2400 0 1 {name=M7
L=0.15
W=20  
nf=1 mult=5
model=nfet_01v8
spiceprefix=X
}
C {devices/capa.sym} 3100 -2890 1 0 {name=C1
m=10
value=5f
footprint=1206
device="ceramic capacitor"}
C {devices/capa.sym} 3300 -3040 0 0 {name=C3
m=5
value=5f
footprint=1206
device="ceramic capacitor"}
C {devices/capa.sym} 2860 -3040 0 0 {name=C2
m=5
value=5f
footprint=1206
device="ceramic capacitor"}
C {devices/vsource.sym} 3270 -2710 0 0 {name=VTuner value=1.5}
C {devices/gnd.sym} 3270 -2660 0 0 {name=l12 lab=GND}
C {devices/gnd.sym} 3100 -2570 0 0 {name=l13 lab=GND}
C {devices/capa.sym} 3090 -2790 1 0 {name=C13
m=34
value=10f
footprint=1206
device="ceramic capacitor"}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3020 -2680 0 0 {name=M6
L=1.8
W=12
nf=1 mult=5
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8_lvt.sym} 3180 -2680 0 1 {name=M3
L=1.8
W=12
nf=1 mult=5
model=nfet_01v8_lvt
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 3070 -3480 0 0 {name=M4
L=0.5
W=20
nf=1 mult=50
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 2680 -3480 0 1 {name=M5
L=0.5
W=20
nf=1 mult=10
model=pfet_01v8
spiceprefix=X
}
